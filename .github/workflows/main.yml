name: Test en playwright

on: 
  workflow_dispatch:

jobs:
 OpenVidu_deployment:
  name:  Run OpenVidu deployment
  runs-on: ubuntu-latest
  steps:
    - name: Check out the repo
      uses: actions/checkout@v2
    - name: Run the build process with Docker
      uses: addnab/docker-run-action@v3
      with:
          image: openvidu/openvidu-dev:2.23.0
          options: "-p 4443:4443 --rm -e OPENVIDU_SECRET=MY_SECRET"
          
 OpenVidu_back:
  name: Run your preferred server application sample
  runs-on: ubuntu-latest
  steps:
    - name: descarga
      run: git clone https://github.com/OpenVidu/openvidu-tutorials.git -b v2.23.0
    - name: acceso a openvidu-basic-node
      run: |
          cd openvidu-tutorials/openvidu-basic-node
          npm install
          node index.js &
    - name: aserver
      run: http-server openvidu-tutorials/openvidu-js/web &
    - name: instalar playwright
      run: |
          wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
          sudo apt install ./google-chrome-stable_current_amd64.deb
          export DISPLAY=:99
          chromedriver --url-base=www.localhost.com &
          sudo Xvfb -ac :99 -screen 0 1280x1024x24 > /dev/null 2>&1 & # optional
      
        
